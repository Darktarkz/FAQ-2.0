<div class="formulario-soporte-container">
  <div class="header-soporte">
    <div class="header-icon">ðŸŽ«</div>
    <h2>Soporte TÃ©cnico</h2>
    <p class="modulo-nombre">{{ moduloNombre }}</p>
  </div>

  <!-- Mensaje de Ã©xito -->
  <div *ngIf="mostrarExito" class="alerta alerta-exito">
    <div class="alerta-contenido">
      <span class="icono-exito">âœ“</span>
      <div>
        <strong>Â¡Ticket creado exitosamente!</strong>
        <p>
          Tu ticket nÃºmero <strong>{{ numeroTicket }}</strong> ha sido registrado. Te contactaremos
          pronto al correo proporcionado.
        </p>
      </div>
    </div>
    <button class="btn-cerrar-alerta" (click)="cerrarMensajeExito()">Ã—</button>
  </div>

  <!-- Mensaje de error -->
  <div *ngIf="mostrarError" class="alerta alerta-error">
    <div class="alerta-contenido">
      <span class="icono-error">âš </span>
      <div>
        <strong>Error</strong>
        <p>{{ mensajeError }}</p>
      </div>
    </div>
    <button class="btn-cerrar-alerta" (click)="cerrarMensajeError()">Ã—</button>
  </div>

  <form (ngSubmit)="enviarTicket()" class="form-soporte">
    <!-- InformaciÃ³n del usuario -->
    <div class="seccion-formulario">
      <h3>InformaciÃ³n Personal</h3>

      <div class="form-group">
        <label for="nombre_completo"> Nombre Completo <span class="requerido">*</span> </label>
        <input
          type="text"
          id="nombre_completo"
          [(ngModel)]="ticket.nombre_completo"
          name="nombre_completo"
          placeholder="Ej: Juan PÃ©rez GarcÃ­a"
          required
        />
      </div>

      <div class="form-row">
        <div class="form-group" *ngIf="config.mostrar_tipo_identificacion">
          <label for="tipo_identificacion">Tipo de IdentificaciÃ³n</label>
          <select
            id="tipo_identificacion"
            [(ngModel)]="ticket.tipo_identificacion"
            name="tipo_identificacion"
          >
            <option *ngFor="let tipo of tiposIdentificacion" [value]="tipo.value">
              {{ tipo.label }}
            </option>
          </select>
        </div>

        <div class="form-group" *ngIf="config.mostrar_cedula">
          <label for="cedula">NÃºmero de IdentificaciÃ³n</label>
          <input
            type="text"
            id="cedula"
            [(ngModel)]="ticket.cedula"
            name="cedula"
            placeholder="Ej: 1234567890"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="correo"> Correo ElectrÃ³nico <span class="requerido">*</span> </label>
          <input
            type="email"
            id="correo"
            [(ngModel)]="ticket.correo"
            name="correo"
            placeholder="ejemplo@correo.com"
            required
          />
        </div>

        <div class="form-group" *ngIf="config.mostrar_telefono">
          <label for="telefono">TelÃ©fono</label>
          <input
            type="tel"
            id="telefono"
            [(ngModel)]="ticket.telefono"
            name="telefono"
            placeholder="Ej: 3001234567"
          />
        </div>
      </div>

      <div class="form-group" *ngIf="config.mostrar_numero_contrato">
        <label for="numero_contrato">NÃºmero de Contrato</label>
        <input
          type="text"
          id="numero_contrato"
          [(ngModel)]="ticket.numero_contrato"
          name="numero_contrato"
          placeholder="Ej: CONT-2026-001"
        />
      </div>
    </div>

    <!-- DescripciÃ³n del problema -->
    <div class="seccion-formulario">
      <h3>DescripciÃ³n del Problema</h3>

      <div class="form-group">
        <label for="descripcion"> Describe el problema <span class="requerido">*</span> </label>
        <textarea
          id="descripcion"
          [(ngModel)]="ticket.descripcion"
          name="descripcion"
          rows="6"
          placeholder="Describe detalladamente el problema que estÃ¡s experimentando..."
          required
        ></textarea>
        <small class="help-text">Incluye pasos para reproducir el error si es posible</small>
      </div>
    </div>

    <!-- Captura de pantalla -->
    <div class="seccion-formulario" *ngIf="config.mostrar_screenshot">
      <h3>Captura de Pantalla (Opcional)</h3>

      <div class="form-group">
        <label for="screenshot" class="label-archivo">
          <span class="icono-upload">ðŸ“Ž</span>
          {{ selectedFile ? 'Cambiar archivo' : 'Seleccionar captura de pantalla' }}
        </label>
        <input
          type="file"
          id="screenshot"
          (change)="onFileSelected($event)"
          accept="image/*"
          style="display: none"
        />
        <small class="help-text">Formatos permitidos: JPG, PNG, GIF (MÃ¡x. 5MB)</small>
      </div>

      <!-- Preview de la imagen -->
      <div *ngIf="previewUrl" class="preview-container">
        <img [src]="previewUrl" alt="Preview" class="preview-image" />
        <button type="button" class="btn-eliminar-imagen" (click)="eliminarImagen()">Ã—</button>
      </div>

      <p *ngIf="selectedFile" class="archivo-seleccionado">
        <span class="icono-check">âœ“</span> {{ selectedFile.name }}
      </p>
    </div>

    <!-- Botones de acciÃ³n -->
    <div class="form-actions">
      <button type="submit" class="btn btn-primary" [disabled]="enviando">
        {{ enviando ? 'Enviando...' : 'Enviar Ticket' }}
      </button>

      <button
        type="button"
        class="btn btn-secondary"
        (click)="resetearFormulario()"
        [disabled]="enviando"
      >
        Limpiar Formulario
      </button>
    </div>

    <p class="nota-privacidad">
      <small>
        Al enviar este formulario, aceptas que tus datos sean utilizados Ãºnicamente para atender tu
        solicitud de soporte.
      </small>
    </p>
  </form>
</div>
